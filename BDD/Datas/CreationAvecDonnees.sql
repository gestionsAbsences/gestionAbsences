-- MySQL Script generated by MySQL Workbench
-- Sat May  6 12:24:10 2017
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema GestAbsences
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `GestAbsences` ;

-- -----------------------------------------------------
-- Schema GestAbsences
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `GestAbsences` DEFAULT CHARACTER SET utf8 ;
USE `GestAbsences` ;

-- -----------------------------------------------------
-- Table `GestAbsences`.`equipe`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `GestAbsences`.`equipe` ;

CREATE TABLE IF NOT EXISTS `GestAbsences`.`equipe` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `nom` VARCHAR(100) NULL,
  `id_responsable` INT NULL,
  `id_hierarchie` INT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_Equipe_Employe1_idx` (`id_responsable` ASC),
  INDEX `fk_Equipe_Equipe1_idx` (`id_hierarchie` ASC))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `GestAbsences`.`service_rh`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `GestAbsences`.`service_rh` ;

CREATE TABLE IF NOT EXISTS `GestAbsences`.`service_rh` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `email` VARCHAR(255) NULL,
  `nom` VARCHAR(45) NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `GestAbsences`.`employe`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `GestAbsences`.`employe` ;

CREATE TABLE IF NOT EXISTS `GestAbsences`.`employe` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `nom` VARCHAR(100) NULL,
  `prenom` VARCHAR(100) NULL,
  `matricule` VARCHAR(45) NULL,
  `nb_cp` INT NULL,
  `nb_rtt` INT NULL,
  `nb_rc` INT NULL,
  `reliquat_ca` INT NULL,
  `reliquat_rtt` INT NULL,
  `id_equipe` INT NULL,
  `id_service_rh` INT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_Personnel_Equipe1_idx` (`id_equipe` ASC),
  INDEX `fk_Employe_ServiceRH1_idx` (`id_service_rh` ASC))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `GestAbsences`.`type`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `GestAbsences`.`type` ;

CREATE TABLE IF NOT EXISTS `GestAbsences`.`type` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `nom` VARCHAR(45) NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `GestAbsences`.`statut`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `GestAbsences`.`statut` ;

CREATE TABLE IF NOT EXISTS `GestAbsences`.`statut` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `nom` VARCHAR(100) NULL,
  `code` INT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `GestAbsences`.`absence`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `GestAbsences`.`absence` ;

CREATE TABLE IF NOT EXISTS `GestAbsences`.`absence` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `debut` DATE NULL,
  `fin` DATE NULL,
  `id_employe` INT NULL,
  `id_type` INT NULL,
  `id_statut` INT NULL,
  `id_service_rh` INT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_Demande_Personnel1_idx` (`id_employe` ASC),
  INDEX `fk_Demande_TypeAbsence1_idx` (`id_type` ASC),
  INDEX `fk_Demande_TypeStatut1_idx` (`id_statut` ASC),
  INDEX `fk_Absence_ServiceRH1_idx` (`id_service_rh` ASC))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `GestAbsences`.`role`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `GestAbsences`.`role` ;

CREATE TABLE IF NOT EXISTS `GestAbsences`.`role` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `valeur` INT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `GestAbsences`.`user`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `GestAbsences`.`user` ;

CREATE TABLE IF NOT EXISTS `GestAbsences`.`user` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `email` VARCHAR(255) NULL,
  `password` VARCHAR(100) NULL,
  `id_employe` INT NULL,
  `id_role` INT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_User_Employe1_idx` (`id_employe` ASC),
  INDEX `fk_User_Role1_idx` (`id_role` ASC))
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;


USE GestAbsences;

SET AUTOCOMMIT=0;
INSERT INTO absence VALUES 
(1,  '2017-02-10', '2017-02-10', 10, 2, 1, 1),
(2,  '2017-02-24', '2017-02-24', 10, 2, 1, 1),
(3,  '2017-03-28', '2017-03-30', 10, 3, 1, 1),
(4,  '2017-04-20', '2017-04-30', 10, 3, 1, 1),
(5,  '2017-05-09', '2017-06-01', 10, 1, 0, 1),
(6,  '2017-06-02', '2017-06-04', 10, 3, 0, 1),
(7,  '2017-06-06', '2017-06-09', 10, 1, 0, 1),
(8,  '2017-01-02', '2017-01-18', 11, 1, 1, 1),
(9,  '2017-01-25', '2017-01-26', 11, 4, 1, 1),
(10, '2017-02-05', '2017-02-05', 11, 2, 1, 1),
(11, '2017-03-15', '2017-03-30', 11, 1, 1, 1),
(12, '2017-04-09', '2017-04-14', 11, 4, 0, 1),
(13, '2017-06-06', '2017-06-09', 11, 1, 1, 1),
(14, '2017-06-12', '2017-06-16', 11, 2, 0, 1),
(15, '2017-01-11', '2017-01-12', 12, 3, 1, 1),
(16, '2017-01-22', '2017-01-26', 12, 2, 1, 1),
(17, '2017-03-01', '2017-03-22', 12, 1, 1, 1),
(18, '2017-04-24', '2017-04-28', 12, 3, 0, 1),
(19, '2017-05-01', '2017-05-22', 12, 1, 0, 1),
(20, '2017-06-02', '2017-06-02', 12, 4, 0, 1),
(21, '2017-06-12', '2017-06-16', 12, 2, 1, 1),
(22, '2017-06-17', '2017-06-23', 12, 3, 0, 1),
(23, '2017-04-25', '2017-05-07', 13, 1, 1, 1),
(24, '2017-06-17', '2017-06-23', 13, 3, 1, 1),
(25, '2017-06-24', '2017-06-30', 13, 4, 0, 1),
(26, '2017-06-24', '2017-06-30', 14, 4, 1, 1);
COMMIT;


SET AUTOCOMMIT=0;
INSERT INTO equipe VALUES (1,'Direction',1,1),
(2,'RH',2,2),
(3,'Moyens généraux',3,3),
(4,'Finance',4,4),
(5,'Sce technique',5,5),
(6,'Production',6,6),
(7,'Commerce',7,7),
(8,'Communication',8,8),
(9,'Secrétariat',9,1),
(10,'Administration',10,1),
(11,'Juridique',11,10),
(12,'Gouvernance',12,10),
(13,'Qualité',13,12),
(14,'Stratégie',14,12),
(15,'Paye',15,2),
(16,'Congés',16,2),
(17,'Social',17,2),
(18,'Gestion du personnel',18,2),
(19,'Vie au travail',19,2),
(20,'Assistance sociale',20,17),
(21,'Recrutement',21,18),
(22,'Discipline',22,18),
(23,'Logistique',23,3),
(24,'Médecine du travail',24,3),
(25,'Gestion client',25,3),
(26,'Courrier',26,3),
(27,'Restaurant',27,3),
(28,'Sécurité',28,25),
(29,'Accueil',29,25),
(30,'Conciergerie',30,25),
(31,'Chauffeur',31,25),
(32,'Comptabilité',32,4),
(33,'Achat',33,4),
(34,'Facturation',34,4),
(35,'Trésorerie',35,4),
(36,'Contrôle de gestion',36,32),
(37,'Synthèse',37,32),
(38,'Analytique',38,32),
(39,'Recouvrement',39,34),
(40,'Maintenance',40,5),
(41,'Ingénierie',41,5),
(42,'SAV',42,40),
(43,'Téléphonie',43,40),
(44,'Support informatique',44,40),
(45,'Innovation',45,41),
(46,'Produit',46,6),
(47,'Vente',47,6),
(48,'Fabrication',48,46),
(49,'Maquette',49,46),
(50,'Stock',50,46),
(51,'Comptoir',51,47),
(52,'Expédition',52,47),
(53,'Conditionnement',53,52),
(54,'Commercial',54,7),
(55,'Marketing',55,7),
(56,'Developpement',56,54),
(57,'Force de vente',57,54),
(58,'Portail',58,55),
(59,'Evenementiel',59,8),
(60,'Publicité',60,8),
(61,'Prospect',61,8);
COMMIT;


SET AUTOCOMMIT=0;
INSERT INTO role VALUES (1,0),
(2,1),
(3,2),
(4,4),
(5,8);
COMMIT;


SET AUTOCOMMIT=0;
INSERT INTO service_rh VALUES (1,'sonia.granger@gmail.com','GRANGER'),
(2,'tania.suchet@gmail.com','SUCHET'),
(3,'yann.lanvin@gmail.com','LANVIN'),
(4,'alex.fiston@gmail.com','FISTON');
COMMIT;


SET AUTOCOMMIT=0;
INSERT INTO statut VALUES (1,'Nouvelle demande', 0),
(2,'En attente de validation du Responsable', 1),
(3,'En attente de décision RH', 2),
(4,'Validé', 3),
(5,'Refusé par le Responsable', 4),
(6,'Refusé par le RH', 5);
COMMIT;


SET AUTOCOMMIT=0;
INSERT INTO type VALUES (1,'Congé payé'),
(2,'RTT'),
(3,'Repos compensateur'),
(4,'Congé maladie'),
(5,'Absence irrégulière'),
(6,'Autres absences');
COMMIT;
